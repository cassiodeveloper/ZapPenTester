using System;

using ZAPPenTester.Factories;
using ZAPPenTester.Models;

namespace ZAPPenTester
{
    /// <summary>
    /// This class is responsible for providing the starting point of the application. 
    /// This application will open ZAP, start the scan and report the findings.
    /// </summary>
    public class Program
    {
        public static void Main(string[] args)
        {
            if (args != null && args.Length == 1)
            {
                string urlToScan = args[0];

                var zap = ZapFactory.Create();

                zap.Open();
                zap.Scan(urlToScan);
                Report report = zap.GetReport(urlToScan);
                zap.Close();

                new CommandLineReportPrinter().Print(report);
            }
            else
            {
                throw new ArgumentException("This tool requires that you provide the URL of the site to be tested as argument, in the format http://www.SiteToTest.com");
            }
        }
    }
}